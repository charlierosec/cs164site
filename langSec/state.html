<html>
  <head>
    <title>State and State Machines</title>
	<base href="https://www.cs.drexel.edu/~src322/cs164/">
	<script src="sidebar.js"></script>
    <link rel="stylesheet" href="langSec/langCSS.css">
  </head>
  <body>
    <div class="sideBar" id="sideBar">
    </div>
    <script>setupSidebar();</script>
    <div class="mainInfo">
      <div class="prevnextcontent">
        <div class="leftprev">
          <a href="langSec/tranq.html">Previous Section</a> : Tranquility : 6.4
        </div>
<!--        <div class="rightnext">
          XXXXXX : XXXXXX : <a href="numSec/XXXXXX">Next Section</a>
        </div> -->
        <br>
      </div>
      <hr>
      <h1>6.5 : State and State Machines</h1>
      <hr>
	  <p>
		What is state?
		Yes, it could perhaps be a place that you live in.
		However, I am notoriously bad at geography, so today, it is not.
		This may be the worst definition, but state defines the current state
		your program is in.
		What defines the current state of your program?
		The state is a snapshot in time.
		At any given moment in time, what are the variables in scope and what
		are their values?
		Based on their values, what will happen next?
		State gets a little more complex than this in future classes. 
		For the purpose of CS-164, this is as deep as you need to know it.
	  </p>
	  <hr>
	  <h2>State Machines and Diagrams</h2>
	  <p>
		One of the things that we work with in CS-164 is the concept of 
		state machines.
		This is something we use to very basically explain the way a program
		functions, what the variables we have mean, and how they affect the 
		way the program will run. 

	  </p>

	  <h3>With One Variable</h3>
	  <p>
		We create a state machine in typically the 
		<a href="labs/fsmlab.html">seventh lab</a>.
		The state machine in this lab relies on one variable and a user 
		input to determine how a program will run and react to the user input.
		In this state machine, there are three button user inputs.
		Based on which button is pressed in which state, you move to a different
		state.
		While there are three states and three buttons, each state is not
		directly tied to a specific button.
		I'm going to further disect what this state machine is doing and how we
		describe that behavior since the actual lab mainly deals with the coding
		part.
	  </p>
	  <p>
		In this state machine, we have one variable named <code>state</code> to
		define what state we are currently in. 
		This variable has an integer range from 0-2 inclusively.
		This means there are three states that our program can be in.
		These three states have no analogy as to what's going on. 
		There is no "good" state to be in and no "bad" state to be in. 
		The code can have side affects based on what state we are currently in.
		For example, the light will turn red when we move from state 2 to state
		0 via the O button. 
		However, this red can be achieved through a variety of different pathways.
		Obviously, this description of behavior gets unwieldy quickly.
		To describe the behavior, we can use two different types of state diagrams.
	  </p>
	  <div class="container">
		<div>
		  <center>
			<b>Table Approach</b>
			<br>
	<table>
		<tr>
			<th></th>
			<th>0</th>
			<th>1</th>
			<th>2</th>
		</tr>
		<tr>
			<th>O</th>
			<td>1/G</td>
			<td>0/G</td>
			<td>0/R</td>
		</tr>
		<tr>
			<th>P</th>
			<td>0/R</td>
			<td>2/G</td>
			<td>1/R</td>
		</tr>
		<tr>
			<th>W</th>
			<td>0/R</td>
			<td>1/R</td>
			<td>1/G</td>
		</tr>
	</table>
	
		  </center>
		</div>

		<div>
		  <center>
			<b>Graphical Bubble Approach</b>
			<br>
			<img src="labs/fsm.png">
		  </center>
		</div>
	  </div>

	  <p>
		Both of the above images describe the state machine from lab 7.
		In the table approach, we have the user inputs in one axis and the state
		in another axis. 
		In the bubble approach, we have each state as a bubble, then the user input
		being an arrow from each to another.
		Which ever you choose to use is up to you and how you best interpret images.
	  </p>

	  <h3>With More Than One Variable</h3>
	  <p>
		The final project for this class is a virtual pet project. 
		It's a really glorified state machine.
		You interact with your pet via buttons and the pet responds accordingly with
		emotions and actions.
		Most people tend to do rather simple state machines with a single <code>state</code>
		variable.
		This is the most straight forward approach.
		However, we tend to have students create pets with certain statistics like
		hunger and happy levels, then have the emotion of the pet be a side effect of that.
		I want to take the time to explain the complexity of a state machine with multiple 
		variables.
	  </p>
	  <p>
		Let's think about a state machine where, instead of one <code>state</code> variable,
		our state is defined by two parts, <code>valA</code> and <code>valB</code>.
		In our purposes, both variables can have values 1-3 inclusively.
		This gives each variable three values each.
		Now, there is no longer three states that our program can be in, there's actually many
		more.
		There are now nine states our state machine can be in.
		There is a state for each combination of variables.
		Below, I've created a table to give a letter to each combination of variables.
		This way we can create an easier to understand state diagram.
	  </p>
	  <center>
		<table>
			<tr>
				<th>State</th>
				<th>A</th>
				<th>B</th>
				<th>C</th>
				<th>D</th>
				<th>E</th>
				<th>F</th>
				<th>G</th>
				<th>H</th>
				<th>I</th>
			</tr>
			<tr>
				<th>valA</th>
				<td>1</td>
				<td>2</td>
				<td>3</td>
				<td>1</td>
				<td>2</td>
				<td>3</td>
				<td>1</td>
				<td>2</td>
				<td>3</td>
			</tr>
			<tr>
				<th>valB</th>
				<td>1</td>
				<td>1</td>
				<td>1</td>
				<td>2</td>
				<td>2</td>
				<td>2</td>
				<td>3</td>
				<td>3</td>
				<td>3</td>
			</tr>
		</table>
	  </center>
	  <p>
		Now that I've described the nine possible states my program can be in,
		let's think about possible user input.
		Let's say there's 4 buttons, labelled W, X, Y, and Z.
		Button W adds 1 to valA.
		Button X subtracts 1 from valA.
		Button Y adds 1 to valB.
		Button Z subtracts 1 from valB.
		For our ease, let's assume that there are strict upper and lower bounds.
		Adding to an upper bound will keep us there.
		Subtracting from a lower bound will keep us there.
		Now that we have a description of the states and the corresponding buttons,
		we can make a diagram that accurately describes this.
	  </p>
	  <div class="container">
		<table>
			<tr>
				<th></th>
				<th>A</th>
				<th>B</th>
				<th>C</th>
				<th>D</th>
				<th>E</th>
				<th>F</th>
				<th>G</th>
				<th>H</th>
				<th>I</th>
			</tr>
			<tr>
				<th>W</th>
				<td>B</td>
				<td>C</td>
				<td>C</td>
				<td>E</td>
				<td>F</td>
				<td>F</td>
				<td>H</td>
				<td>I</td>
				<td>I</td>
			</tr>
			<tr>
				<th>X</th>
				<td>A</td>
				<td>A</td>
				<td>B</td>
				<td>D</td>
				<td>D</td>
				<td>E</td>
				<td>G</td>
				<td>G</td>
				<td>H</td>
			</tr>
			<tr>
				<th>Y</th>
				<td>D</td>
				<td>E</td>
				<td>F</td>
				<td>G</td>
				<td>H</td>
				<td>I</td>
				<td>G</td>
				<td>H</td>
				<td>I</td>
			</tr>
			<tr>
				<th>Z</th>
				<td>A</td>
				<td>B</td>
				<td>C</td>
				<td>A</td>
				<td>B</td>
				<td>C</td>
				<td>D</td>
				<td>E</td>
				<td>F</td>
			</tr>	
		</table>
		<img src="langSec/2varfsm.png">

	  </div>
	  <p>
		Clearly, our state diagram has gotten very complex.
		Using our diagram, we can see that in order to get from state A to 
		state H, we need to press the buttons, Y, then W, then Y in order.
		We really get to see the behavior of our program now.
		From here, we can have further side effects to our program.
		In states where valA is greater than valB (B, C, F) perhaps a yellow
		light turns on. 
		While multiple states can have the same side effect, they are still
		separate states with separate values for their variables.
		As you increase the number of variables and the number of values for 
		each variable, you exponentially increase the complexity of the program.
		Just something to keep in mind.
	  </p>

	  <hr>
      <div class="prevnextcontent">
        <div class="leftprev">
          <a href="langSec/tranq.html">Previous Section</a> : Tranquility : 6.4
        </div>
<!--        <div class="rightnext">
          XXXXXX : XXXXXX : <a href="numSec/">Next Section</a>
        </div> -->
        <br>
      </div>
    </div>
  </body>
</html>
